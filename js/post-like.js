function initPostLike(){const t=document.getElementById("article-container");if(!t)return;if(document.querySelector(".post-like-container"))return;const e=window.location.pathname;const n=createLikeButton(e);const o=document.querySelector(".post-reward");if(o){o.after(n)}else{t.parentElement.insertBefore(n,t.nextSibling)}loadLikeStatus(e)}function createLikeButton(t){const e=document.createElement("div");e.className="post-like-container";e.innerHTML=`
    <button class="post-like-button" id="post-like-btn" data-url="${t}">
      <i class="fas fa-heart post-like-icon"></i>
      <span class="post-like-count" id="post-like-count">0</span>
      <span class="post-like-text">点赞</span>
    </button>
  `;const n=e.querySelector("#post-like-btn");n.addEventListener("click",handleLikeClick);return e}function handleLikeClick(t){const e=t.currentTarget;const n=e.dataset.url;e.classList.add("clicking");setTimeout(()=>e.classList.remove("clicking"),300);const o=getLikeData(n);if(o.liked){o.liked=false;o.count=Math.max(0,o.count-1);e.classList.remove("liked");e.querySelector(".post-like-text").textContent="点赞"}else{o.liked=true;o.count+=1;e.classList.add("liked");e.querySelector(".post-like-text").textContent="已点赞"}e.querySelector("#post-like-count").textContent=o.count;saveLikeData(n,o)}function getLikeData(t){const e=`article_like_${t}`;const n=localStorage.getItem(e);if(n){try{return JSON.parse(n)}catch(t){console.error("解析点赞数据失败:",t)}}return{liked:false,count:0}}function saveLikeData(t,e){const n=`article_like_${t}`;try{localStorage.setItem(n,JSON.stringify(e))}catch(t){console.error("保存点赞数据失败:",t)}}function loadLikeStatus(t){const e=document.getElementById("post-like-btn");if(!e)return;const n=getLikeData(t);if(n.liked){e.classList.add("liked");e.querySelector(".post-like-text").textContent="已点赞"}e.querySelector("#post-like-count").textContent=n.count}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",initPostLike)}else{initPostLike()}document.addEventListener("pjax:complete",initPostLike);