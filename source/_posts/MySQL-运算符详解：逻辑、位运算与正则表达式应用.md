---
title: MySQL 运算符详解：逻辑、位运算与正则表达式应用
date: 2025-08-18 11:32:24
tags: [MySQL]
categories: [数据库]
---
# MySQL 运算符详解：逻辑、位运算与正则表达式应用

在 MySQL 中，运算符是构建复杂查询条件的基础。除了基础的算术和比较运算符，逻辑运算符、位运算符以及正则表达式的灵活运用，能让数据筛选更加精准高效。本文将系统讲解这些运算符的用法、规则及实战技巧，帮助你掌握复杂查询的核心技能。

## 一、逻辑运算符：多条件组合的核心

逻辑运算符用于组合多个条件，判断表达式的真假，返回结果为1（真）、0（假）或NULL（未知）。常用的有四种：

### 1. 逻辑非（NOT / !）

**作用**：对条件结果取反

**语法**：NOT 条件 或 ! 条件

**规则**：

- 条件为0（假）时返回1；

- 条件为非0（真）时返回0；

- 条件为NULL时返回NULL。

**示例**：

```sql
-- 查询薪资不在9000-12000之间的员工
SELECT employee_id, salary 
FROM employees 
WHERE NOT (salary >= 9000 AND salary <= 12000);
```

### 2. 逻辑与（AND / &&）

**作用**：所有条件同时为真时返回1

**语法**：条件1 AND 条件2 或 条件1 && 条件2

**规则**：

- 所有条件非0且非NULL时返回1；

- 任意条件为0时返回0；

- 存在NULL且无0时返回NULL。

**示例**：

```sql
-- 查询部门30中薪资>5000的员工
SELECT last_name, salary 
FROM employees 
WHERE department_id = 30 AND salary > 5000;
```

### 3. 逻辑或（OR / ||）

**作用**：任意条件为真时返回1

**语法**：条件1 OR 条件2 或 条件1 || 条件2

**规则**：

- 任意条件非0时返回1；

- 所有条件为0时返回0；

- 存在NULL且无真条件时返回NULL。

**注意**：AND优先级高于OR，建议用括号明确逻辑

**示例**：

```sql
-- 正确：查询薪资>10000 或 （岗位含MAN且薪资>5000）的员工
SELECT last_name, job_id, salary 
FROM employees 
WHERE salary > 10000 OR (job_id LIKE '%MAN%' AND salary > 5000);
```

### 4. 逻辑异或（XOR）

**作用**：两个条件一真一假时返回1（“异” 即不同）

**语法**：条件1 XOR 条件2

**规则**：

- 一真一假（非0和0）时返回1；

- 同真或同假时返回0；

- 任意条件为NULL时返回NULL。

**示例**：

```sql
-- 查询部门为10/20 或 薪资>8000，但不同时满足的员工
SELECT last_name, department_id, salary 
FROM employees 
WHERE department_id IN (10, 20) XOR salary > 8000;
```

## 二、位运算符：二进制层面的运算

位运算符直接对数值的二进制位进行操作，适用于底层数据处理（如权限控制）。运算时先将数值转为二进制，计算后再转回十进制。

| 运算符 | 名称     | 作用说明                       | 示例（6→110，3→011）              |
| ------ | -------- | ------------------------------ | --------------------------------- |
| &      | 按位与   | 对应位都为 1 则返回 1，否则 0  | 6 & 3 = 2（110 & 011=010）        |
| \|     | \|       | 按位或                         | 对应位有一个为 1 则返回 1，否则 0 |
| ^      | 按位异或 | 对应位不同则返回 1，相同则 0   | 6 ^ 3 = 5（110 ^ 011=101）        |
| ~      | 按位取反 | 0→1，1→0（结果为原数的补码）   | ~6 = -7（补码运算）               |
| >>     | 按位右移 | 二进制位右移指定位数，高位补 0 | 6 >> 1 = 3（110→11）              |
| <<     | 按位左移 | 二进制位左移指定位数，低位补 0 | 6 << 1 = 12（110→1100）           |

**示例**：

```sql
-- 判断权限位是否包含某角色（假设8对应二进制1000，代表管理员权限）
SELECT user_id, role_bits 
FROM users 
WHERE (role_bits & 8) = 8;  -- 结果为8表示包含管理员权限
```

## 三、运算符优先级：避免逻辑混乱

运算符优先级决定计算顺序，优先级高的先执行。记不清时，**用括号****()****强制指定顺序**（推荐）。

**优先级从高到低（核心）**：

1. 括号()（最高）

1. 位运算符（~、<<、>>、&、^、|）

1. 算术运算符（*、/、% 高于 +、-）

1. 比较运算符（=、>、BETWEEN、IN等）

1. 逻辑运算符（NOT > AND > OR、XOR）

1. 赋值运算符（=，最低）

**示例**：

```sql
-- 错误：因AND优先级高，可能不符合预期
SELECT * FROM employees WHERE salary>5000 OR salary<3000 AND department_id=30;

-- 正确：用括号明确先算OR的两边
SELECT * FROM employees WHERE (salary>5000 OR salary<3000) AND department_id=30;
```

## 四、正则表达式：复杂字符串匹配

REGEXP支持灵活的字符串模式匹配，比LIKE更适合复杂场景。常用匹配规则如下：

| 模式符号     | 作用                    | 示例                                       |
| ------------ | ----------------------- | ------------------------------------------ |
| ^            | 匹配开头                | '^b' 匹配以 b 开头的字符串                 |
| $            | 匹配结尾                | 'y$' 匹配以 y 结尾的字符串                 |
| .            | 匹配任意单个字符        | 'a.g' 匹配 a 和 g 之间有一个任意字符       |
| *            | 匹配前面字符 0 次或多次 | 'ba*' 匹配 b 后接 0 个或多个 a（b、ba 等） |
| +            | 匹配前面字符至少 1 次   | 'ba+' 匹配 b 后接 1 个或多个 a（ba、baa）  |
| `        | ` | 匹配多个选项之一        |                                            |
| []           | 匹配括号内任意单个字符  | '[ot]' 匹配 o 或 t                         |
| [^]          | 匹配括号外任意字符      | '[^0-9]' 匹配非数字字符                    |
| {n,}         | 匹配前面字符至少 n 次   | 'x{2,}' 匹配 x 至少出现 2 次               |
| {n,m}        | 匹配前面字符 n 到 m 次  | 'ba{1,3}' 匹配 ba、baa、baaa               |

**示例**：

```sql
-- 1. 匹配以b开头且后面有至少1个a的字符串
SELECT f_name FROM fruits WHERE f_name REGEXP '^ba+';

-- 2. 匹配包含on或ap的字符串
SELECT f_name FROM fruits WHERE f_name REGEXP 'on|ap';

-- 3. 匹配x连续出现至少2次的字符串
SELECT f_name FROM fruits WHERE f_name REGEXP 'x{2,}';
```

**与 LIKE 的区别**：

- REGEXP匹配字符串中**任意位置**的模式（如'bon' REGEXP 'on'返回 1）；

- LIKE需用通配符才能匹配中间内容（如'bon' LIKE '%on%'才返回 1）。

## 五、总结：核心要点速览

1. **逻辑运算符**：

- - NOT取反，AND需全真，OR需一真，XOR需一真一假；

- - 注意AND优先级高于OR，用括号明确逻辑。

1. **位运算符**：

- - 对二进制位操作，适用于权限控制等底层场景；

- - 常用&（判断位是否为 1）、<</>>（移位运算）。

1. **优先级**：

- - 括号最高，赋值最低；不确定时用括号强制顺序。

1. **正则表达式**：

- - REGEXP支持复杂模式匹配，灵活度远超LIKE；

- - 掌握^/$/[]/{}等符号，可应对多数字符串筛选需求。

熟练运用这些运算符，能让你在处理多条件查询和复杂字符串匹配时更加得心应手，写出高效、精准的 SQL 语句。